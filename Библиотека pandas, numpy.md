# Pandas и NumPy: основные и часто используемые конструкции

## Библиотека NumPy

NumPy - фундаментальная библиотека для научных вычислений в Python, предоставляющая поддержку многомерных массивов и математических функций.

Поддерживает векторные вычисления, за счёт чего скорость вычислений возрастает в разы (не прибегая к циклам).

### Основные конструкции NumPy

```python
import numpy as np

# Создание массивов
arr1 = np.array([1, 2, 3, 4, 5])  # одномерный массив
arr2 = np.array([[1, 2, 3], [4, 5, 6]])  # двумерный массив
zeros = np.zeros((3, 4))  # массив из нулей
ones = np.ones((2, 3))  # массив из единиц
arange = np.arange(0, 10, 2)  # аналог range, но возвращает массив
linspace = np.linspace(0, 1, 5)  # 5 чисел от 0 до 1 с равным интервалом
random_arr = np.random.rand(3, 3)  # случайные числа от 0 до 1

# Основные операции
arr = np.array([1, 2, 3, 4])
arr + 2  # [3, 4, 5, 6] - поэлементные операции
arr * arr  # [1, 4, 9, 16]
arr.mean()  # среднее значение
arr.max()  # максимальное значение
arr.reshape((2, 2))  # изменение формы массива

# Индексация и срезы
arr = np.array([1, 2, 3, 4, 5])
arr[1]  # 2
arr[1:4]  # array([2, 3, 4])
arr[arr > 2]  # array([3, 4, 5]) - булева индексация

# Матричные операции
a = np.array([[1, 2], [3, 4]])
b = np.array([[5, 6], [7, 8]])
np.dot(a, b)  # матричное умножение
a @ b  # альтернативный синтаксис матричного умножения
```

## Библиотека Pandas

Pandas предоставляет высокоуровневые структуры данных и инструменты для анализа данных.

### Основные конструкции Pandas

```python
import pandas as pd

# Создание DataFrame
df = pd.DataFrame({
    'Имя': ['Анна', 'Борис', 'Света'],
    'Возраст': [25, 30, 28],
    'Город': ['Москва', 'Новосибирск', 'Екатеринбург']
})

# Чтение данных
df = pd.read_csv('data.csv')  # из CSV
df = pd.read_excel('data.xlsx')  # из Excel

# Основные операции с DataFrame
df.head()  # первые 5 строк
df.tail(3)  # последние 3 строки
df.shape  # размерность (строки, столбцы)
df.columns  # список названий столбцов
df.info()  # информация о DataFrame
df.describe()  # статистика по числовым столбцам

# Работа со столбцами
df['Имя']  # выбор столбца
df[['Имя', 'Возраст']]  # выбор нескольких столбцов
df['Зарплата'] = [50000, 60000, 55000]  # добавление столбца

# Фильтрация данных
df[df['Возраст'] > 25]  # фильтр по условию
df.query('Возраст > 25 and Город == "Москва"')  # альтернативный синтаксис

# Группировка и агрегация
df.groupby('Город')['Возраст'].mean()  # средний возраст по городам
df.groupby('Город').agg({'Возраст': ['mean', 'min', 'max']})

# Работа с пропущенными значениями
df.isna()  # проверка на пропущенные значения
df.dropna()  # удаление строк с пропущенными значениями
df.fillna(0)  # замена пропущенных значений на 0

# Сортировка
df.sort_values('Возраст', ascending=False)  # сортировка по возрасту (по убыванию)

# Объединение DataFrame
df1 = pd.DataFrame({'key': ['A', 'B', 'C'], 'value': [1, 2, 3]})
df2 = pd.DataFrame({'key': ['B', 'C', 'D'], 'value': [4, 5, 6]})
pd.merge(df1, df2, on='key')  # внутреннее соединение
pd.concat([df1, df2])  # конкатенация DataFrame

# Серии (Series) - одномерные структуры Pandas
s = pd.Series([1, 3, 5, np.nan, 6, 8])
s.mean()  # среднее значение
s.value_counts()  # подсчет уникальных значений
```

### Часто используемые методы

1. **Применение функций**:
```python
df['Возраст'].apply(lambda x: x + 1)  # применение функции к столбцу
```

2. **Pivot-таблицы**:
```python
pd.pivot_table(df, values='Возраст', index='Город', aggfunc='mean')
```

3. **Работа с датами**:
```python
df['Дата'] = pd.to_datetime(df['Дата'])
df['Год'] = df['Дата'].dt.year
```

4. **Сохранение данных**:
```python
df.to_csv('output.csv', index=False)
df.to_excel('output.xlsx', sheet_name='Данные')
```

Эти конструкции составляют основу работы с Pandas и NumPy и покрывают большинство повседневных задач анализа данных.


[[!Вопросы к экзамену]]