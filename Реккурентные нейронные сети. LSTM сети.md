–û—Ç–ª–∏—á–Ω–æ! –î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º —Ç–µ–º—É **—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π (RNN)** –∏ **LSTM** —Ç–∞–∫, —á—Ç–æ–±—ã —Ç—ã –ø–æ–Ω—è–ª –∏ —Å–º–æ–≥ –æ–±—ä—è—Å–Ω–∏—Ç—å –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ.  

---

## **1. –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (RNN)**  

### **1.1. –ß—Ç–æ —Ç–∞–∫–æ–µ RNN?**  
RNN ‚Äî —ç—Ç–æ —Ç–∏–ø –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –¥–∞–Ω–Ω—ã—Ö** (—Ç–µ–∫—Å—Ç, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã, —Ä–µ—á—å –∏ —Ç. –¥.).  

**–ì–ª–∞–≤–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å RNN:**  
- –£ –Ω–∏—Ö –µ—Å—Ç—å **"–ø–∞–º—è—Ç—å"** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏, –Ω–æ –∏ –º–µ–∂–¥—É **—à–∞–≥–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**.  
- –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ RNN –ø–æ–ª—É—á–∞–µ—Ç **–Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ + —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞.  

### **1.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ RNN**  
![RNN —Å—Ö–µ–º–∞](https://miro.medium.com/max/1400/1*L6a7zn51xqx2rT1_2p09HA.png)  

- **x‚Çú** ‚Äî –≤—Ö–æ–¥ –Ω–∞ —à–∞–≥–µ *t*  
- **h‚Çú** ‚Äî —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ —à–∞–≥–µ *t*  
- **y‚Çú** ‚Äî –≤—ã—Ö–æ–¥ –Ω–∞ —à–∞–≥–µ *t*  

**–§–æ—Ä–º—É–ª—ã:**  
\[
$h_t = \sigma(W_{xh} x_t + W_{hh} h_{t-1} + b_h)$
\]  
\[
$y_t = \sigma(W_{hy} h_t + b_y)$
\]  

–ì–¥–µ:  
- \( $W_{xh}, W_{hh}, W_{hy}$ \) ‚Äî –º–∞—Ç—Ä–∏—Ü—ã –≤–µ—Å–æ–≤  
- \( $b_h, b_y$ \) ‚Äî —Å–º–µ—â–µ–Ω–∏—è  
- \( $\sigma$ \) ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–æ–±—ã—á–Ω–æ tanh –∏–ª–∏ ReLU)  

### **1.3. –ü—Ä–æ–±–ª–µ–º—ã RNN**  
1. **–ü—Ä–æ–±–ª–µ–º–∞ –∏—Å—á–µ–∑–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞** ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏, –∏ —Å–µ—Ç—å –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –æ–±—É—á–∞—Ç—å—Å—è –Ω–∞ –¥–ª–∏–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö.  
2. **–ü—Ä–æ–±–ª–µ–º–∞ –≤–∑—Ä—ã–≤–∞—é—â–µ–≥–æ—Å—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞** ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏ (—Ä–µ—à–∞–µ—Ç—Å—è –æ–±—Ä–µ–∑–∫–æ–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞).  

**‚Üí –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ RNN –ø–ª–æ—Ö–æ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.**  

---

## **2. LSTM (Long Short-Term Memory)**  

### **2.1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã LSTM?**  
LSTM ‚Äî —ç—Ç–æ —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è RNN, –∫–æ—Ç–æ—Ä–∞—è **–ª—É—á—à–µ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –∑–∞ —Å—á—ë—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.  

### **2.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LSTM**  
![LSTM —Å—Ö–µ–º–∞](https://colah.github.io/posts/2015-08-Understanding-LSTMs/img/LSTM3-chain.png)  

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**  
1. **–ó–∞–±—ã–≤–∞—é—â–∏–π –≥–µ–π—Ç (Forget Gate)** ‚Äî —Ä–µ—à–∞–µ—Ç, –∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∑–∞–±—ã—Ç—å.  
2. **–í—Ö–æ–¥–Ω–æ–π –≥–µ–π—Ç (Input Gate)** ‚Äî —Ä–µ—à–∞–µ—Ç, –∫–∞–∫—É—é –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∑–∞–ø–æ–º–Ω–∏—Ç—å.  
3. **–ì–µ–π—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (Update Gate)** ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏.  
4. **–í—ã—Ö–æ–¥–Ω–æ–π –≥–µ–π—Ç (Output Gate)** ‚Äî —Ä–µ—à–∞–µ—Ç, –∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª—å—à–µ.  

**–§–æ—Ä–º—É–ª—ã:**  
\[
$f_t = \sigma(W_f \cdot [h_{t-1}, x_t] + b_f) \quad \text{(Forget Gate)}$
\]  
\[
$i_t = \sigma(W_i \cdot [h_{t-1}, x_t] + b_i) \quad \text{(Input Gate)}$
\]  
\[
$\tilde{C}_t = \tanh(W_C \cdot [h_{t-1}, x_t] + b_C) \quad \text{(–ö–∞–Ω–¥–∏–¥–∞—Ç –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)}$
\]  
\[
$C_t = f_t \odot C_{t-1} + i_t \odot \tilde{C}_t \quad \text{(–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è)}$
\]  
\[
$o_t = \sigma(W_o \cdot [h_{t-1}, x_t] + b_o) \quad \text{(Output Gate)}$
\]  
\[
$h_t = o_t \odot \tanh(C_t) \quad \text{(–ù–æ–≤–æ–µ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)}$
\]  

–ì–¥–µ:  
- \( $\odot$ \) ‚Äî –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ (Hadamard product)  
- \( $C_t$ \) ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–∞–º—è—Ç—å)  

### **2.3. –ü–æ—á–µ–º—É LSTM –ª—É—á—à–µ RNN?**  
- **–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ –∑–∞–±—ã–≤–∞–Ω–∏–µ** (Forget Gate)  
- **–ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤–∞–∂–Ω–æ–≥–æ** (Input Gate)  
- **–ò–∑–±–µ–≥–∞–Ω–∏–µ –∏—Å—á–µ–∑–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞** –∑–∞ —Å—á—ë—Ç "–±—ã—Å—Ç—Ä–æ–≥–æ –ø—É—Ç–∏" (—Å–æ—Å—Ç–æ—è–Ω–∏–µ —è—á–µ–π–∫–∏ \( C_t \))  

---

## **3. –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è**  
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ (NLP):**  
  - –ú–∞—à–∏–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ (Seq2Seq)  
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞  
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã:**  
  - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω –∞–∫—Ü–∏–π  
  - –ê–Ω–∞–ª–∏–∑ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
- **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏**  

---

## **4. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É LSTM –∏ GRU**  
GRU (Gated Recurrent Unit) ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è LSTM:  
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç Forget –∏ Input Gate –≤ –æ–¥–∏–Ω **Update Gate**  
- –ù–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π —è—á–µ–π–∫–∏ \( C_t \), —Ç–æ–ª—å–∫–æ —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ \( h_t \)  

**–ü–ª—é—Å—ã GRU:**  
- –ú–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Üí –±—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–µ–Ω–∏–µ  
- –ò–Ω–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ö—É–∂–µ LSTM  

---

## **5. –ö–æ–¥ –Ω–∞ PyTorch (–ø—Ä–∏–º–µ—Ä LSTM)**  
```python
import torch
import torch.nn as nn

# –°–æ–∑–¥–∞—ë–º LSTM —Å–µ—Ç—å
lstm = nn.LSTM(input_size=10, hidden_size=20, num_layers=2)

# –í—Ö–æ–¥: (seq_len, batch, input_size)
input = torch.randn(5, 3, 10)  # 5 —à–∞–≥–æ–≤, 3 –ø—Ä–∏–º–µ—Ä–∞, 10 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
h0 = torch.randn(2, 3, 20)  # (num_layers, batch, hidden_size)
c0 = torch.randn(2, 3, 20)

# –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ LSTM
output, (hn, cn) = lstm(input, (h0, c0))
print(output.shape)  # (5, 3, 20)
```

---

## **–í—ã–≤–æ–¥**  
- **RNN** ‚Äî –ø—Ä–æ—Å—Ç—ã–µ, –Ω–æ —Å—Ç—Ä–∞–¥–∞—é—Ç –æ—Ç –ø—Ä–æ–±–ª–µ–º —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏.  
- **LSTM** ‚Äî —Ä–µ—à–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—É –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∑–∞ —Å—á—ë—Ç –≥–µ–π—Ç–æ–≤.  
- **GRU** ‚Äî –±–æ–ª–µ–µ –ª—ë–≥–∫–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ LSTM.  

–¢–µ–ø–µ—Ä—å —Ç—ã –≥–æ—Ç–æ–≤ –æ–±—ä—è—Å–Ω–∏—Ç—å —ç—Ç–æ –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ! üöÄ  

**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–≥–ª—É–±–∏—Ç—å –∫–∞–∫—É—é-—Ç–æ —á–∞—Å—Ç—å ‚Äî —Å–ø—Ä–∞—à–∏–≤–∞–π!**